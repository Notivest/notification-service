spring.application.name=notification-service

# Datasource (PostgreSQL by default)
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:notification_service}}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:notification_service}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:notification_service}
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.hikari.maximum-pool-size=${SPRING_DATASOURCE_MAX_POOL_SIZE:10}

# JPA & Hibernate
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# Flyway (runs against the same datasource)
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration

# Security (JWT)
spring.security.oauth2.resourceserver.jwt.issuer-uri=${JWT_ISSUER_URI:}
spring.security.oauth2.resourceserver.jwt.audience=${JWT_AUDIENCE:}
# Fallback email used only when Spring profile 'default-email' is active
notification.security.default-email=${JWT_DEFAULT_EMAIL:default-profile@notivest.local}

portfolio.service.base-url=${PORTFOLIO_SERVICE_BASE_URL:http://portfolio-service:8080}
portfolio.service.connect-timeout=${PORTFOLIO_SERVICE_CONNECT_TIMEOUT:PT0.5S}
portfolio.service.read-timeout=${PORTFOLIO_SERVICE_READ_TIMEOUT:PT3S}
portfolio.service.auth.domain=${PORTFOLIO_SERVICE_AUTH0_DOMAIN}
portfolio.service.auth.client-id=${PORTFOLIO_SERVICE_AUTH0_CLIENT_ID}
portfolio.service.auth.client-secret=${PORTFOLIO_SERVICE_AUTH0_CLIENT_SECRET}
portfolio.service.auth.audience=${PORTFOLIO_SERVICE_AUTH0_AUDIENCE}
portfolio.service.auth.scope=${PORTFOLIO_SERVICE_AUTH0_SCOPE}
portfolio.service.auth.connect-timeout=${PORTFOLIO_SERVICE_AUTH_CONNECT_TIMEOUT}
portfolio.service.auth.read-timeout=${PORTFOLIO_SERVICE_AUTH_READ_TIMEOUT}
portfolio.service.auth.clock-skew=${PORTFOLIO_SERVICE_AUTH_CLOCK_SKEW}


# Deduplication
dedup.window-minutes=${DEDUP_WINDOW_MINUTES:5}

# Email
notification.email.from=${NOTIFICATION_EMAIL_FROM:notifications@example.com}
spring.mail.host=${SMTP_HOST:localhost}
spring.mail.port=${SMTP_PORT:1025}
spring.mail.username=${SMTP_USERNAME:}
spring.mail.password=${SMTP_PASSWORD:}
spring.mail.properties.mail.smtp.auth=${SMTP_AUTH:false}
spring.mail.properties.mail.smtp.starttls.enable=${SMTP_STARTTLS:false}

# Email worker
notification.email.worker.enabled=${NOTIFICATION_EMAIL_WORKER_ENABLED:true}
notification.email.worker.batch-size=${NOTIFICATION_EMAIL_WORKER_BATCH_SIZE:25}
notification.email.worker.fixed-delay-ms=${NOTIFICATION_EMAIL_WORKER_DELAY_MS:5000}
